<!DOCTYPE html>
<html lang="en">
	<%- include('../../components/admin/head') %>
	<body class="theme-light">
		<div class="page">
			<%- include('../../components/admin/menu') %>

			<div class="page-wrapper">
				<%- include('../../components/admin/page-header') %>
				<div class="page-body">
					<span id="file" class="d-none"><%= JSON.stringify(file) %></span>
					<% const fileTitle = file[0].replace(".md", "") %>
					<form id="file-form" action="/admin-update/<%= fileTitle %>" method="post">
						<div class="container-xl">
							<div class="card">
								<div class="card-body">
									<div class="row m-auto">
										<% const filePath = file[1].path.split("../").pop() %>
										<input
											type="text"
											name="filePath"
											id="file-path"
											class="d-none"
											value="<%= filePath %>"
										/>
										<% if (filePath.includes("/pages/")) { %> <%#
										<!-- PAGE FRONT MATTER -->
										%>
										<div id="page-front-matter" class="col-lg-6">
											<div>
												<label for="page-title-input" class="form-label">
													<b>Page title* - REQUIRED !</b>
												</label>
												<div class="invalid-tooltip position-relative">
													Page title cannot be empty !
												</div>
												<input
													type="text"
													name="pageTitle"
													id="page-title-input"
													class="form-control"
													placeholder="Type your page title here"
													value="<%= file[1].data.title %>"
													required
												/>
											</div>

											<div>
												<label for="page-description-input" class="form-label">
													<b>Page description* - REQUIRED !</b>
												</label>
												<div class="invalid-tooltip position-relative">
													Page description cannot be empty !
												</div>
												<input
													type="text"
													name="pageDescription"
													id="page-description-input"
													class="form-control"
													placeholder="Describe your page's content shortly"
													value="<%= file[1].data.description %>"
													required
												/>
											</div>

											<div>
												<label for="page-image-select" class="form-label">
													Page image - Optional, better for design
												</label>
												<select name="pageImage" id="page-image-select" class="form-select">
													<option value="">Choose an image from the gallery</option>
													<% if (file[1].data.featuredImage) { %>
													<option value="<%= file[1].data.featuredImage %>" selected>
														<%= file[1].data.featuredImage.split("/").pop() %>
													</option>
													<% let otherImages = images.filter(image => image !==
													file[1].data.featuredImage) %><%#
													<!-- Display the other images from the gallery -->
													%> <% otherImages.forEach(image => { %> <%#
													<!-- Get the filename of each other image -->
													%> <% const otherImageName = image.split("/").pop() %>
													<option value="<%= image %>"><%= otherImageName %></option>
													<% }) %> <%#
													<!-- If the page doesn't have a featuredImage -->
													%> <% } else { %> <%#
													<!-- Comment added for readability -->
													%> <% images.forEach(image => { %> <%#
													<!-- Get the filename of each image -->
													%> <% const imageName = image.split("/").pop() %>
													<option value="<%= image %>"><%= imageName %></option>
													<% }) %> <% } %>
												</select>
											</div>
										</div>
										<% } %> <%#
										<!-- Comment added for readability -->
										%> <% if (filePath.includes("/posts/")) { %> <%#
										<!-- POST FRONT MATTER -->
										%>
										<div id="post-front-matter" class="col-lg-6">
											<div>
												<label for="post-title-input" class="form-label">
													<b>Post title* - REQUIRED !</b>
												</label>
												<div class="invalid-tooltip position-relative">
													Post title cannot be empty !
												</div>
												<input
													type="text"
													name="postTitle"
													id="post-title-input"
													class="form-control"
													placeholder="Type your post title here"
													value="<%= file[1].data.title %>"
													required
												/>
											</div>

											<div>
												<label for="post-date-input" class="form-label">
													<b>Post Date* - REQUIRED !</b>
												</label>
												<div class="invalid-tooltip position-relative">
													A post must have a date !
												</div>
												<input type="date" name="postDate" id="post-date-input"
												class="form-control" value="<%= file[1].data.date.split("/").join("-")
												%>" required />
											</div>

											<div>
												<label for="post-description-input" class="form-label">
													Post description - Optional, better for SEO
												</label>
												<input
													type="text"
													name="postDescription"
													id="post-description-input"
													class="form-control"
													placeholder="Describe your post's content shortly"
													value="<%= file[1].data.description %>"
												/>
											</div>

											<div>
												<label for="post-image-select" class="form-label">
													Post image - Optional, better for design
												</label>
												<select name="postImage" id="post-image-select" class="form-select">
													<option value="">Choose an image from the gallery</option>
													<% if (file[1].data.featuredImage) { %>
													<option value="<%= file[1].data.featuredImage %>" selected>
														<%= file[1].data.featuredImage.split("/").pop() %>
													</option>
													<% let otherImages = images.filter(image => image !==
													file[1].data.featuredImage) %><%#
													<!-- Display the other images from the gallery -->
													%> <% otherImages.forEach(image => { %> <%#
													<!-- Get the filename of each other image -->
													%> <% const otherImageName = image.split("/").pop() %>
													<option value="<%= image %>"><%= otherImageName %></option>
													<% }) %> <%#
													<!-- If the post doesn't have a featuredImage -->
													%> <% } else { %> <%#
													<!-- Comment added for readability -->
													%> <% images.forEach(image => { %> <%#
													<!-- Get the filename of each image -->
													%> <% const imageName = image.split("/").pop() %>
													<option value="<%= image %>"><%= imageName %></option>
													<% }) %> <% } %>
												</select>
											</div>

											<div>
												<label for="post-tags-input" class="form-label">
													Post tag(s) - Optional, better for categorizing
												</label>
												<input
													type="text"
													name="postTags"
													id="post-tags-input"
													class="form-control"
													placeholder="Coffee, Mood, Wall-Decor, JS-Party"
													value="<%= file[1].data.tags %>"
												/>
											</div>
										</div>
										<% } %>
									</div>
									<div class="my-3">
										<label class="form-label">Markdown editor</label>
										<%# TOAST UI EDITOR %>
										<div id="editor"></div>

										<%# Hidden textarea to get the content from the above editor %>
										<div class="d-none">
											<textarea
												name="fileContents"
												id="file-contents"
												rows="10"
												class="form-control"
											></textarea>
										</div>
									</div>
								</div>

								<div class="card-footer">
									<button id="submit-button" type="button" class="btn btn-primary">Submit</button>
								</div>
							</div>
						</div>
					</form>
				</div>
				<%- include('../../components/admin/footer') %>
			</div>
		</div>
		<%- include('../../components/admin/adminScripts') %>
	</body>
</html>
